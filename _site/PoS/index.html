<!DOCTYPE html> <!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--> <!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8"><![endif]--> <!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9"><![endif]--> <!--[if gt IE 8]><!--> <html class="no-js"><!--<![endif]--> <head> <meta charset="UTF-8"> <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"> <meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"> <title>go 实现 Proof_of_Stake 共识机制 &#8211; Shadow Knight</title> <meta name="description" content="go_PoS_共识算法"> <meta name="keywords" content="PoS, go"> <!-- Twitter Cards --> <meta name="twitter:card" content="summary"> <meta name="twitter:image" content="http://localhost:4000/assets/img/logo.png"> <meta name="twitter:title" content="go 实现 Proof_of_Stake 共识机制"> <meta name="twitter:description" content="go_实现 POS共识机制"> <meta name="twitter:site" content="@username"> <meta name="twitter:creator" content="@username"> <!-- Open Graph --> <meta property="og:locale" content="en_US"> <meta property="og:type" content="article"> <meta property="og:title" content="go 实现 Proof_of_Stake 共识机制"> <meta property="og:description" content="go_实现 POS共识机制"> <meta property="og:url" content="http://localhost:4000/PoS/"> <meta property="og:site_name" content="Shadow Knight"> <meta property="og:image" content="http://localhost:4000/assets/img/logo.png"> <link rel="canonical" href="http://localhost:4000/PoS/"> <link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="Shadow Knight Feed"> <!-- Handheld --> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- CSS --> <link rel="stylesheet" href="http://localhost:4000/assets/css/main.css"> <!-- JS --> <script src="http://localhost:4000/assets/js/modernizr-3.3.1.custom.min.js"></script> <!-- Favicons --> <link rel="apple-touch-icon" href="http://localhost:4000/assets/img/favicons/apple-icon-precomposed.png"> <link rel="apple-touch-icon" sizes="72x72" href="http://localhost:4000/assets/img/favicons/apple-icon-72x72.png"> <link rel="apple-touch-icon" sizes="114x114" href="http://localhost:4000/assets/img/favicons/apple-icon-114x114.png"> <link rel="apple-touch-icon" sizes="144x144" href="http://localhost:4000/assets/img/favicons/apple-icon-144x144.png"> <link rel="shortcut icon" type="image/png" href="http://localhost:4000/favicon.png" /> <link rel="shortcut icon" href="http://localhost:4000/favicon.ico" /> <!-- Background Image --> <style type="text/css">body {background-image:url(http://localhost:4000/assets/img/placeholder-big.jpg); background-repeat: no-repeat; background-size: cover; }</style> <!-- Post Feature Image --> </head> <body> <nav id="dl-menu" class="dl-menuwrapper" role="navigation"> <button class="dl-trigger">Open Menu</button> <ul class="dl-menu"> <li><a href="http://localhost:4000/">Home</a></li> <li> <a href="#">About</a> <ul class="dl-submenu"> <li> <img src="http://localhost:4000/assets/img/logo.png" alt="Shadow Knight photo" class="author-photo"> <h4>Shadow Knight</h4> <p>非常欢迎大家来参观我的个人博客</p> </li> <li><a href="http://localhost:4000/about/"><span class="btn btn-inverse">Learn More</span></a></li> <li> <a href="http://twitter.com/username" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-twitter-square"></i> Twitter</a> </li> <li> <a href="http://facebook.com/username" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-facebook-square"></i> Facebook</a> </li> <li> <a href="http://instagram.com/username" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-instagram"></i> Instagram</a> </li> <li> <a href="http://github.com/z547743799" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-github"></i> Github</a> </li> <li> <a href="http://steamcommunity.com/id/username" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-steam-square"></i> Steam</a> </li> </ul><!-- /.dl-submenu --> </li> <li> <a href="#">Posts</a> <ul class="dl-submenu"> <li><a href="http://localhost:4000/posts/">All Posts</a></li> <li><a href="http://localhost:4000/tags/">All Tags</a></li> </ul> </li> <li><a href="http://localhost:4000/projects/" >Projects</a></li> </ul><!-- /.dl-menu --> </nav><!-- /.dl-menuwrapper --> <!-- Header --> <header class="header" role="banner"> <div class="wrapper animated fadeIn"> <div class="content"> <div class="post-title "> <h1>go 实现 Proof_of_Stake 共识机制</h1> <h4>22 May 2018</h4> <p class="reading-time"> <i class="fa fa-clock-o"></i> Reading time ~4 minutes </p><!-- /.entry-reading-time --> <a class="btn zoombtn" href="http://localhost:4000/projects/"> <i class="fa fa-chevron-left"></i> </a> </div> <h1 id="使用-go-实现-proof-of-stake-共识机制">使用 go 实现 Proof of Stake 共识机制</h1> <h2 id="什么是-proof-of-stake">什么是 Proof of Stake</h2> <p>在PoW中，节点之间通过hash的计算力来竞赛以获取下一个区块的记账权，而在PoS中，块是已经铸造好的，铸造的过程是基于每个节点(Node)愿意作为抵押的令牌(Token)数量。如果验证者愿意提供更多的令牌作为抵押品，他们就有更大的机会记账下一个区块并获得奖励。</p> <h2 id="实现-proof-of-stake-主要功能点">实现 Proof of Stake 主要功能点</h2> <ul> <li>我们将有一个中心化的TCP服务节点，其他节点可以连接该服务器</li> <li>最新的区块链状态将定期广播到每个节点</li> <li>每个节点都能提议建立新的区块</li> <li>基于每个节点的令牌数量，其中一个节点将随机地(以令牌数作为加权值)作为获胜者，并且将该区块添加到区块链中</li> </ul> <h2 id="实现-proof-of-stake">实现 Proof of Stake</h2> <h3 id="设置-tcp-服务器的端口">设置 TCP 服务器的端口</h3> <p>新建 <code class="highlighter-rouge">.env.text</code>文件，添加如下内容 <code class="highlighter-rouge">PORT=9000</code></p> <h3 id="安装依赖软件">安装依赖软件</h3> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ go get github.com/davecgh/go-spew/spew

$ go get github.com/joho/godotenv
</code></pre></div></div> <ul> <li> <p><code class="highlighter-rouge">spew</code> 在控制台中格式化输出相应的结果。</p> </li> <li> <p><code class="highlighter-rouge">godotenv</code> 可以从我们项目的根目录的 <code class="highlighter-rouge">.env</code> 文件中读取数据。</p> </li> </ul> <h3 id="引入相应的包">引入相应的包</h3> <p>新建 <code class="highlighter-rouge">main.go</code>，引入相应的包</p> <div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">package</span><span class="x"> </span><span class="n">main</span><span class="x">

</span><span class="k">import</span><span class="x"> </span><span class="p">(</span><span class="x">
	</span><span class="s">"sync"</span><span class="x">
	</span><span class="s">"crypto/sha256"</span><span class="x">
	</span><span class="s">"encoding/hex"</span><span class="x">
	</span><span class="s">"github.com/joho/godotenv"</span><span class="x">
	</span><span class="s">"log"</span><span class="x">
	</span><span class="s">"time"</span><span class="x">
	</span><span class="s">"github.com/davecgh/go-spew/spew"</span><span class="x">
	</span><span class="s">"os"</span><span class="x">
	</span><span class="s">"net"</span><span class="x">
	</span><span class="s">"io"</span><span class="x">
	</span><span class="s">"encoding/json"</span><span class="x">
	</span><span class="s">"bufio"</span><span class="x">
	</span><span class="s">"strconv"</span><span class="x">
	</span><span class="s">"fmt"</span><span class="x">
	</span><span class="s">"math/rand"</span><span class="x">
</span><span class="p">)</span><span class="x">

</span><span class="c">//创建区块</span><span class="x">
</span><span class="k">type</span><span class="x"> </span><span class="n">Block</span><span class="x"> </span><span class="k">struct</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="c">//区块高度</span><span class="x">
	</span><span class="n">Index</span><span class="x"> </span><span class="kt">int</span><span class="x">
	</span><span class="c">//时间戳</span><span class="x">
	</span><span class="n">Timestamp</span><span class="x"> </span><span class="kt">string</span><span class="x">
	</span><span class="c">//是每分钟跳动的次数，是你的脉率</span><span class="x">
	</span><span class="n">BPM</span><span class="x"> </span><span class="kt">int</span><span class="x">
	</span><span class="c">//当前区块hash</span><span class="x">
	</span><span class="n">Hash</span><span class="x"> </span><span class="kt">string</span><span class="x">
	</span><span class="c">//上一个区块hash</span><span class="x">
	</span><span class="n">PrevHash</span><span class="x"> </span><span class="kt">string</span><span class="x">
	</span><span class="c">//区块验证者</span><span class="x">
	</span><span class="n">Validator</span><span class="x"> </span><span class="kt">string</span><span class="x">
</span><span class="p">}</span><span class="x">

</span><span class="c">//声明区块链数组</span><span class="x">
</span><span class="k">var</span><span class="x"> </span><span class="n">Blockchain</span><span class="x"> </span><span class="p">[]</span><span class="n">Block</span><span class="x">
</span><span class="k">var</span><span class="x"> </span><span class="n">tempBlocks</span><span class="x"> </span><span class="p">[]</span><span class="n">Block</span><span class="x">

</span><span class="c">//创建通道，确保线程间传参,candidateBlocks保存block</span><span class="x">
</span><span class="k">var</span><span class="x"> </span><span class="n">candidateBlocks</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="nb">make</span><span class="p">(</span><span class="k">chan</span><span class="x"> </span><span class="n">Block</span><span class="p">)</span><span class="x">
</span><span class="c">//存放网络中广播的内容</span><span class="x">
</span><span class="k">var</span><span class="x"> </span><span class="n">announcements</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="nb">make</span><span class="p">(</span><span class="k">chan</span><span class="x"> </span><span class="kt">string</span><span class="p">)</span><span class="x">

</span><span class="c">//确保线程互斥</span><span class="x">
</span><span class="k">var</span><span class="x"> </span><span class="n">mutex</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="o">&amp;</span><span class="n">sync</span><span class="o">.</span><span class="n">Mutex</span><span class="p">{}</span><span class="x">

</span><span class="c">//创建map,存放节点的地址和tokens</span><span class="x">
</span><span class="k">var</span><span class="x"> </span><span class="n">validators</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="nb">make</span><span class="p">(</span><span class="k">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">int</span><span class="p">)</span><span class="x">

</span><span class="c">//随机生成代理验证人地址</span><span class="x">
</span><span class="k">func</span><span class="x"> </span><span class="n">calculateHash</span><span class="p">(</span><span class="n">s</span><span class="x"> </span><span class="kt">string</span><span class="p">)</span><span class="x"> </span><span class="kt">string</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="n">h</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">sha256</span><span class="o">.</span><span class="n">New</span><span class="p">()</span><span class="x">
	</span><span class="n">h</span><span class="o">.</span><span class="n">Write</span><span class="p">([]</span><span class="kt">byte</span><span class="p">(</span><span class="n">s</span><span class="p">))</span><span class="x">
	</span><span class="n">hashed</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">h</span><span class="o">.</span><span class="n">Sum</span><span class="p">(</span><span class="no">nil</span><span class="p">)</span><span class="x">
	</span><span class="k">return</span><span class="x"> </span><span class="n">hex</span><span class="o">.</span><span class="n">EncodeToString</span><span class="p">(</span><span class="n">hashed</span><span class="p">)</span><span class="x">
</span><span class="p">}</span><span class="x">

</span><span class="c">//创建blockhash值</span><span class="x">
</span><span class="k">func</span><span class="x"> </span><span class="n">calculateBlockHash</span><span class="p">(</span><span class="n">block</span><span class="x"> </span><span class="n">Block</span><span class="p">)</span><span class="x"> </span><span class="kt">string</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="n">record</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="kt">string</span><span class="p">(</span><span class="n">block</span><span class="o">.</span><span class="n">Index</span><span class="p">)</span><span class="x"> </span><span class="o">+</span><span class="x"> </span><span class="n">block</span><span class="o">.</span><span class="n">Timestamp</span><span class="x"> </span><span class="o">+</span><span class="x"> </span><span class="kt">string</span><span class="p">(</span><span class="n">block</span><span class="o">.</span><span class="n">BPM</span><span class="p">)</span><span class="x"> </span><span class="o">+</span><span class="x">
		</span><span class="n">block</span><span class="o">.</span><span class="n">PrevHash</span><span class="x">
	</span><span class="k">return</span><span class="x"> </span><span class="n">calculateHash</span><span class="p">(</span><span class="n">record</span><span class="p">)</span><span class="x">
</span><span class="p">}</span><span class="x">

</span><span class="c">//验证区块的合法性</span><span class="x">
</span><span class="k">func</span><span class="x"> </span><span class="n">isBlockValid</span><span class="p">(</span><span class="n">newBlock</span><span class="p">,</span><span class="x"> </span><span class="n">oldBlock</span><span class="x"> </span><span class="n">Block</span><span class="p">)</span><span class="x"> </span><span class="kt">bool</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="k">if</span><span class="x"> </span><span class="n">oldBlock</span><span class="o">.</span><span class="n">Index</span><span class="o">+</span><span class="m">1</span><span class="x"> </span><span class="o">!=</span><span class="x"> </span><span class="n">newBlock</span><span class="o">.</span><span class="n">Index</span><span class="x"> </span><span class="p">{</span><span class="x">
		</span><span class="k">return</span><span class="x"> </span><span class="no">false</span><span class="x">
	</span><span class="p">}</span><span class="x">
	</span><span class="k">if</span><span class="x"> </span><span class="n">oldBlock</span><span class="o">.</span><span class="n">Hash</span><span class="x"> </span><span class="o">!=</span><span class="x"> </span><span class="n">newBlock</span><span class="o">.</span><span class="n">PrevHash</span><span class="x"> </span><span class="p">{</span><span class="x">
		</span><span class="k">return</span><span class="x"> </span><span class="no">false</span><span class="x">
	</span><span class="p">}</span><span class="x">
	</span><span class="k">if</span><span class="x"> </span><span class="n">calculateBlockHash</span><span class="p">(</span><span class="n">newBlock</span><span class="p">)</span><span class="x"> </span><span class="o">!=</span><span class="x"> </span><span class="n">newBlock</span><span class="o">.</span><span class="n">Hash</span><span class="x"> </span><span class="p">{</span><span class="x">
		</span><span class="k">return</span><span class="x"> </span><span class="no">false</span><span class="x">
	</span><span class="p">}</span><span class="x">
	</span><span class="k">return</span><span class="x"> </span><span class="no">true</span><span class="x">

</span><span class="p">}</span><span class="x">

</span><span class="k">func</span><span class="x"> </span><span class="n">main</span><span class="p">()</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="c">//读取.env文件内容</span><span class="x">
	</span><span class="n">err</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">godotenv</span><span class="o">.</span><span class="n">Load</span><span class="p">()</span><span class="x">
	</span><span class="k">if</span><span class="x"> </span><span class="n">err</span><span class="x"> </span><span class="o">!=</span><span class="x"> </span><span class="no">nil</span><span class="x"> </span><span class="p">{</span><span class="x">
		</span><span class="n">log</span><span class="o">.</span><span class="n">Fatal</span><span class="p">(</span><span class="n">err</span><span class="p">)</span><span class="x">
	</span><span class="p">}</span><span class="x">

	</span><span class="c">// 创建创世区块</span><span class="x">
	</span><span class="n">t</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">time</span><span class="o">.</span><span class="n">Now</span><span class="p">()</span><span class="x">
	</span><span class="n">genesisBlock</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">Block</span><span class="p">{}</span><span class="x">
	</span><span class="n">genesisBlock</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="n">Block</span><span class="p">{</span><span class="m">0</span><span class="p">,</span><span class="x"> </span><span class="n">t</span><span class="o">.</span><span class="n">String</span><span class="p">(),</span><span class="x">
		</span><span class="m">0</span><span class="p">,</span><span class="x"> </span><span class="n">calculateBlockHash</span><span class="p">(</span><span class="n">genesisBlock</span><span class="p">),</span><span class="x"> </span><span class="s">""</span><span class="p">,</span><span class="x"> </span><span class="s">""</span><span class="p">}</span><span class="x">
	</span><span class="c">//格式化区块，确保在终端的输出</span><span class="x">
	</span><span class="n">spew</span><span class="o">.</span><span class="n">Dump</span><span class="p">(</span><span class="n">genesisBlock</span><span class="p">)</span><span class="x">
	</span><span class="c">//将创世区块存放到区块链</span><span class="x">
	</span><span class="n">Blockchain</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="nb">append</span><span class="p">(</span><span class="n">Blockchain</span><span class="p">,</span><span class="x"> </span><span class="n">genesisBlock</span><span class="p">)</span><span class="x">

	</span><span class="c">//读取.env文件内容</span><span class="x">
	</span><span class="n">httpPort</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">os</span><span class="o">.</span><span class="n">Getenv</span><span class="p">(</span><span class="s">"PORT"</span><span class="p">)</span><span class="x">

	</span><span class="c">// 监听网络端口</span><span class="x">
	</span><span class="n">server</span><span class="p">,</span><span class="x"> </span><span class="n">err</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">net</span><span class="o">.</span><span class="n">Listen</span><span class="p">(</span><span class="s">"tcp"</span><span class="p">,</span><span class="x"> </span><span class="s">":"</span><span class="o">+</span><span class="n">httpPort</span><span class="p">)</span><span class="x">
	</span><span class="c">//推迟关闭</span><span class="x">
	</span><span class="k">defer</span><span class="x"> </span><span class="n">server</span><span class="o">.</span><span class="n">Close</span><span class="p">()</span><span class="x">

	</span><span class="c">// 启动了一个Go routine 从 candidateBlocks 通道中获取提议的区块，然后填充到临时缓冲区 tempBlocks 中</span><span class="x">
	</span><span class="k">go</span><span class="x"> </span><span class="k">func</span><span class="p">()</span><span class="x"> </span><span class="p">{</span><span class="x">
		</span><span class="k">for</span><span class="x"> </span><span class="n">candidate</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="k">range</span><span class="x"> </span><span class="n">candidateBlocks</span><span class="x"> </span><span class="p">{</span><span class="x">
			</span><span class="c">//添加线程所，确保线程互斥</span><span class="x">
			</span><span class="n">mutex</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span><span class="x">
			</span><span class="c">//当candidateblocks通道有数据时，就会添加临时缓冲区</span><span class="x">
			</span><span class="n">tempBlocks</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="nb">append</span><span class="p">(</span><span class="n">tempBlocks</span><span class="p">,</span><span class="x"> </span><span class="n">candidate</span><span class="p">)</span><span class="x">
			</span><span class="n">mutex</span><span class="o">.</span><span class="n">Unlock</span><span class="p">()</span><span class="x">
		</span><span class="p">}</span><span class="x">
	</span><span class="p">}()</span><span class="x">

	</span><span class="c">// 启动了一个Go routine 完成 pickWinner 函数</span><span class="x">
	</span><span class="k">go</span><span class="x"> </span><span class="k">func</span><span class="p">()</span><span class="x"> </span><span class="p">{</span><span class="x">
		</span><span class="k">for</span><span class="x"> </span><span class="p">{</span><span class="x">
			</span><span class="c">//查找谁去挖矿</span><span class="x">
			</span><span class="n">pickWinner</span><span class="p">()</span><span class="x">
		</span><span class="p">}</span><span class="x">
	</span><span class="p">}()</span><span class="x">

	</span><span class="c">// 等待接收验证者节点的连接</span><span class="x">
	</span><span class="k">for</span><span class="x"> </span><span class="p">{</span><span class="x">
		</span><span class="c">//如果没有不开线层</span><span class="x">
		</span><span class="n">conn</span><span class="p">,</span><span class="x"> </span><span class="n">err</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">server</span><span class="o">.</span><span class="n">Accept</span><span class="p">()</span><span class="x">
		</span><span class="k">if</span><span class="x"> </span><span class="n">err</span><span class="x"> </span><span class="o">!=</span><span class="x"> </span><span class="no">nil</span><span class="x"> </span><span class="p">{</span><span class="x">
			</span><span class="n">log</span><span class="o">.</span><span class="n">Fatal</span><span class="p">(</span><span class="n">err</span><span class="p">)</span><span class="x">
		</span><span class="p">}</span><span class="x">
		</span><span class="k">go</span><span class="x"> </span><span class="n">handleConn</span><span class="p">(</span><span class="n">conn</span><span class="p">)</span><span class="x">
	</span><span class="p">}</span><span class="x">

</span><span class="p">}</span><span class="x">

</span><span class="c">//输入令牌的余额（之前提到过，我们不做钱包等逻辑)</span><span class="x">
</span><span class="c">//接收区块链的最新广播</span><span class="x">
</span><span class="c">//接收验证者赢得区块的广播信息</span><span class="x">
</span><span class="c">//将自身节点添加到全局的验证者列表中（validators)</span><span class="x">
</span><span class="c">//输入Block的BPM数据- BPM是每个验证者的人体脉搏值</span><span class="x">
</span><span class="c">//提议创建一个新的区块</span><span class="x">
</span><span class="c">//模拟获取连接者的tokens(币)和地址和BPM(心跳值)</span><span class="x">
</span><span class="k">func</span><span class="x"> </span><span class="n">handleConn</span><span class="p">(</span><span class="n">conn</span><span class="x"> </span><span class="n">net</span><span class="o">.</span><span class="n">Conn</span><span class="p">)</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="k">defer</span><span class="x"> </span><span class="n">conn</span><span class="o">.</span><span class="n">Close</span><span class="p">()</span><span class="x">
	</span><span class="c">//广播已经被验证的区块</span><span class="x">
	</span><span class="k">go</span><span class="x"> </span><span class="k">func</span><span class="p">()</span><span class="x"> </span><span class="p">{</span><span class="x">
		</span><span class="k">for</span><span class="x"> </span><span class="p">{</span><span class="x">
			</span><span class="n">msg</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="o">&lt;-</span><span class="n">announcements</span><span class="x">
			</span><span class="c">//在每个服务器控制台进行广播</span><span class="x">
			</span><span class="n">io</span><span class="o">.</span><span class="n">WriteString</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span><span class="x"> </span><span class="n">msg</span><span class="p">)</span><span class="x">
		</span><span class="p">}</span><span class="x">
	</span><span class="p">}()</span><span class="x">
	</span><span class="c">// 验证者地址</span><span class="x">
	</span><span class="k">var</span><span class="x"> </span><span class="n">address</span><span class="x"> </span><span class="kt">string</span><span class="x">

	</span><span class="c">// 验证者输入他所拥有的 tokens，tokens 的值越大，越容易获得新区块的记账权</span><span class="x">
	</span><span class="n">io</span><span class="o">.</span><span class="n">WriteString</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span><span class="x"> </span><span class="s">"Enter token balance:"</span><span class="p">)</span><span class="x">
	</span><span class="n">scanBalance</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">bufio</span><span class="o">.</span><span class="n">NewScanner</span><span class="p">(</span><span class="n">conn</span><span class="p">)</span><span class="x">
	</span><span class="k">for</span><span class="x"> </span><span class="n">scanBalance</span><span class="o">.</span><span class="n">Scan</span><span class="p">()</span><span class="x"> </span><span class="p">{</span><span class="x">
		</span><span class="c">// 获取输入的数据，并将输入的值转为 int</span><span class="x">
		</span><span class="n">balance</span><span class="p">,</span><span class="x"> </span><span class="n">err</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">strconv</span><span class="o">.</span><span class="n">Atoi</span><span class="p">(</span><span class="n">scanBalance</span><span class="o">.</span><span class="n">Text</span><span class="p">())</span><span class="x">
		</span><span class="k">if</span><span class="x"> </span><span class="n">err</span><span class="x"> </span><span class="o">!=</span><span class="x"> </span><span class="no">nil</span><span class="x"> </span><span class="p">{</span><span class="x">
			</span><span class="n">log</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"%v not a number: %v"</span><span class="p">,</span><span class="x"> </span><span class="n">scanBalance</span><span class="o">.</span><span class="n">Text</span><span class="p">(),</span><span class="x"> </span><span class="n">err</span><span class="p">)</span><span class="x">
			</span><span class="k">return</span><span class="x">
		</span><span class="p">}</span><span class="x">
		</span><span class="n">t</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">time</span><span class="o">.</span><span class="n">Now</span><span class="p">()</span><span class="x">
		</span><span class="c">// 生成验证者的地址</span><span class="x">
		</span><span class="n">address</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="n">calculateHash</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">String</span><span class="p">())</span><span class="x">
		</span><span class="c">// 将验证者的地址和token 存储到 validators</span><span class="x">
		</span><span class="n">validators</span><span class="p">[</span><span class="n">address</span><span class="p">]</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="n">balance</span><span class="x">
		</span><span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">validators</span><span class="p">)</span><span class="x">
		</span><span class="k">break</span><span class="x">
	</span><span class="p">}</span><span class="x">

	</span><span class="n">io</span><span class="o">.</span><span class="n">WriteString</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span><span class="x"> </span><span class="s">"</span><span class="se">\n</span><span class="s">Enter a new BPM:"</span><span class="p">)</span><span class="x">

	</span><span class="n">scanBPM</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">bufio</span><span class="o">.</span><span class="n">NewScanner</span><span class="p">(</span><span class="n">conn</span><span class="p">)</span><span class="x">

	</span><span class="k">go</span><span class="x"> </span><span class="k">func</span><span class="p">()</span><span class="x"> </span><span class="p">{</span><span class="x">
		</span><span class="k">for</span><span class="x"> </span><span class="p">{</span><span class="x">
			</span><span class="c">// take in BPM from stdin and add it to blockchain after conducting necessary validation</span><span class="x">
			</span><span class="k">for</span><span class="x"> </span><span class="n">scanBPM</span><span class="o">.</span><span class="n">Scan</span><span class="p">()</span><span class="x"> </span><span class="p">{</span><span class="x">
				</span><span class="n">bpm</span><span class="p">,</span><span class="x"> </span><span class="n">err</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">strconv</span><span class="o">.</span><span class="n">Atoi</span><span class="p">(</span><span class="n">scanBPM</span><span class="o">.</span><span class="n">Text</span><span class="p">())</span><span class="x">
				</span><span class="c">// 如果验证者试图提议一个被污染（例如伪造）的block，例如包含一个不是整数的BPM，那么程序会抛出一个错误，我们会立即从我们的验证器列表validators中删除该验证者，他们将不再有资格参与到新块的铸造过程同时丢失相应的抵押令牌。</span><span class="x">
				</span><span class="k">if</span><span class="x"> </span><span class="n">err</span><span class="x"> </span><span class="o">!=</span><span class="x"> </span><span class="no">nil</span><span class="x"> </span><span class="p">{</span><span class="x">
					</span><span class="n">log</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"%v not a number: %v"</span><span class="p">,</span><span class="x"> </span><span class="n">scanBPM</span><span class="o">.</span><span class="n">Text</span><span class="p">(),</span><span class="x"> </span><span class="n">err</span><span class="p">)</span><span class="x">
					</span><span class="nb">delete</span><span class="p">(</span><span class="n">validators</span><span class="p">,</span><span class="x"> </span><span class="n">address</span><span class="p">)</span><span class="x">
					</span><span class="n">conn</span><span class="o">.</span><span class="n">Close</span><span class="p">()</span><span class="x">
				</span><span class="p">}</span><span class="x">

				</span><span class="n">mutex</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span><span class="x">
				</span><span class="n">oldLastIndex</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">Blockchain</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">Blockchain</span><span class="p">)</span><span class="o">-</span><span class="m">1</span><span class="p">]</span><span class="x">
				</span><span class="n">mutex</span><span class="o">.</span><span class="n">Unlock</span><span class="p">()</span><span class="x">

				</span><span class="c">// 创建新的区块，然后将其发送到 candidateBlocks 通道</span><span class="x">
				</span><span class="n">newBlock</span><span class="p">,</span><span class="x"> </span><span class="n">err</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">generateBlock</span><span class="p">(</span><span class="n">oldLastIndex</span><span class="p">,</span><span class="x"> </span><span class="n">bpm</span><span class="p">,</span><span class="x"> </span><span class="n">address</span><span class="p">)</span><span class="x">
				</span><span class="k">if</span><span class="x"> </span><span class="n">err</span><span class="x"> </span><span class="o">!=</span><span class="x"> </span><span class="no">nil</span><span class="x"> </span><span class="p">{</span><span class="x">
					</span><span class="n">log</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">err</span><span class="p">)</span><span class="x">
					</span><span class="k">continue</span><span class="x">
				</span><span class="p">}</span><span class="x">
				</span><span class="k">if</span><span class="x"> </span><span class="n">isBlockValid</span><span class="p">(</span><span class="n">newBlock</span><span class="p">,</span><span class="x"> </span><span class="n">oldLastIndex</span><span class="p">)</span><span class="x"> </span><span class="p">{</span><span class="x">
					</span><span class="n">candidateBlocks</span><span class="x"> </span><span class="o">&lt;-</span><span class="x"> </span><span class="n">newBlock</span><span class="x">
				</span><span class="p">}</span><span class="x">
				</span><span class="n">io</span><span class="o">.</span><span class="n">WriteString</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span><span class="x"> </span><span class="s">"</span><span class="se">\n</span><span class="s">Enter a new BPM:"</span><span class="p">)</span><span class="x">
			</span><span class="p">}</span><span class="x">
		</span><span class="p">}</span><span class="x">
	</span><span class="p">}()</span><span class="x">

	</span><span class="c">// 每个连入服务器的代理人会循环会周期性的打印出最新的区块链信息</span><span class="x">
	</span><span class="k">for</span><span class="x"> </span><span class="p">{</span><span class="x">
		</span><span class="n">time</span><span class="o">.</span><span class="n">Sleep</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">Minute</span><span class="p">)</span><span class="x">
		</span><span class="n">mutex</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span><span class="x">
		</span><span class="n">output</span><span class="p">,</span><span class="x"> </span><span class="n">err</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">json</span><span class="o">.</span><span class="n">Marshal</span><span class="p">(</span><span class="n">Blockchain</span><span class="p">)</span><span class="x">
		</span><span class="n">mutex</span><span class="o">.</span><span class="n">Unlock</span><span class="p">()</span><span class="x">
		</span><span class="k">if</span><span class="x"> </span><span class="n">err</span><span class="x"> </span><span class="o">!=</span><span class="x"> </span><span class="no">nil</span><span class="x"> </span><span class="p">{</span><span class="x">
			</span><span class="n">log</span><span class="o">.</span><span class="n">Fatal</span><span class="p">(</span><span class="n">err</span><span class="p">)</span><span class="x">
		</span><span class="p">}</span><span class="x">
		</span><span class="n">io</span><span class="o">.</span><span class="n">WriteString</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span><span class="x"> </span><span class="kt">string</span><span class="p">(</span><span class="n">output</span><span class="p">)</span><span class="o">+</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span><span class="x">
	</span><span class="p">}</span><span class="x">

</span><span class="p">}</span><span class="x">

</span><span class="c">// pickWinner创建了一个验证者的彩票池并选择 可以为区块链伪造一个块的验证器</span><span class="x">
</span><span class="c">// 通过从池中随机选择，用标记的数量加权</span><span class="x">
</span><span class="k">func</span><span class="x"> </span><span class="n">pickWinner</span><span class="p">()</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="c">//保证有服务器连入使temp切片中有值</span><span class="x">
	</span><span class="n">time</span><span class="o">.</span><span class="n">Sleep</span><span class="p">(</span><span class="m">30</span><span class="x"> </span><span class="o">*</span><span class="x"> </span><span class="n">time</span><span class="o">.</span><span class="n">Second</span><span class="p">)</span><span class="x">
	</span><span class="n">mutex</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span><span class="x">
	</span><span class="n">temp</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">tempBlocks</span><span class="x">
	</span><span class="n">mutex</span><span class="o">.</span><span class="n">Unlock</span><span class="p">()</span><span class="x">

	</span><span class="n">lotteryPool</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="p">[]</span><span class="kt">string</span><span class="p">{}</span><span class="x">
	</span><span class="k">if</span><span class="x"> </span><span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span><span class="x"> </span><span class="o">&gt;</span><span class="x"> </span><span class="m">0</span><span class="x"> </span><span class="p">{</span><span class="x">

		</span><span class="c">// 稍微修改了传统的赌注算法</span><span class="x">
		</span><span class="c">// 所有提交一个块的验证器, 通过标记标记的数量来增加它们的权重。</span><span class="x">
		</span><span class="c">// 在传统的股权证明中, 确认器可以参与，而不需要提交一个块来伪造</span><span class="x">
	</span><span class="n">OUTER</span><span class="o">:</span><span class="x">
		</span><span class="k">for</span><span class="x"> </span><span class="n">_</span><span class="p">,</span><span class="x"> </span><span class="n">block</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="k">range</span><span class="x"> </span><span class="n">temp</span><span class="x"> </span><span class="p">{</span><span class="x">
			</span><span class="c">//temp=tempBlocks=candidateBlocks</span><span class="x">
			</span><span class="c">//  如果遍历中已经存在代理人的地址值跳过循环执行下一次遍历</span><span class="x">
			</span><span class="k">for</span><span class="x"> </span><span class="n">_</span><span class="p">,</span><span class="x"> </span><span class="n">node</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="k">range</span><span class="x"> </span><span class="n">lotteryPool</span><span class="x"> </span><span class="p">{</span><span class="x">

				</span><span class="k">if</span><span class="x"> </span><span class="n">block</span><span class="o">.</span><span class="n">Validator</span><span class="x"> </span><span class="o">==</span><span class="x"> </span><span class="n">node</span><span class="x"> </span><span class="p">{</span><span class="x">
					</span><span class="k">continue</span><span class="x"> </span><span class="n">OUTER</span><span class="x">
				</span><span class="p">}</span><span class="x">
			</span><span class="p">}</span><span class="x">

			</span><span class="c">// 锁定验证器列表，以防止数据竞争</span><span class="x">
			</span><span class="n">mutex</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span><span class="x">
			</span><span class="n">setValidators</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">validators</span><span class="x">
			</span><span class="n">mutex</span><span class="o">.</span><span class="n">Unlock</span><span class="p">()</span><span class="x">
			</span><span class="c">//在以 k, ok := setValidators[block.Validator]开始的代码块中，</span><span class="x">
			</span><span class="c">// 我们确保了从temp中取出来的验证者都是合法的，</span><span class="x">
			</span><span class="c">// 即这些验证者在验证者列表validators已存在。若合法，则把该验证者加入到lotteryPool中。</span><span class="x">
			</span><span class="c">// 获取验证者的tokens</span><span class="x">
			</span><span class="n">k</span><span class="p">,</span><span class="x"> </span><span class="n">ok</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">setValidators</span><span class="p">[</span><span class="n">block</span><span class="o">.</span><span class="n">Validator</span><span class="p">]</span><span class="x">
			</span><span class="k">if</span><span class="x"> </span><span class="n">ok</span><span class="x"> </span><span class="p">{</span><span class="x">
				</span><span class="c">// 向 lotteryPool 追加 k 条数据，k 代表的是当前验证者的tokens</span><span class="x">
				</span><span class="k">for</span><span class="x"> </span><span class="n">i</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="m">0</span><span class="p">;</span><span class="x"> </span><span class="n">i</span><span class="x"> </span><span class="o">&lt;</span><span class="x"> </span><span class="n">k</span><span class="p">;</span><span class="x"> </span><span class="n">i</span><span class="o">++</span><span class="x"> </span><span class="p">{</span><span class="x">
					</span><span class="n">lotteryPool</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="nb">append</span><span class="p">(</span><span class="n">lotteryPool</span><span class="p">,</span><span class="x"> </span><span class="n">block</span><span class="o">.</span><span class="n">Validator</span><span class="p">)</span><span class="x">
				</span><span class="p">}</span><span class="x">
			</span><span class="p">}</span><span class="x">
		</span><span class="p">}</span><span class="x">

		</span><span class="c">// 通过随机获得获胜节点的地址</span><span class="x">

		</span><span class="n">s</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">rand</span><span class="o">.</span><span class="n">NewSource</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">Now</span><span class="p">()</span><span class="o">.</span><span class="n">Unix</span><span class="p">())</span><span class="x">
		</span><span class="n">r</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">rand</span><span class="o">.</span><span class="n">New</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="x">
		</span><span class="n">lotteryWinner</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">lotteryPool</span><span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">Intn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lotteryPool</span><span class="p">))]</span><span class="x">

		</span><span class="c">// 把获胜者的区块添加到整条区块链上，然后通知所有节点关于胜利者的消息</span><span class="x">
		</span><span class="k">for</span><span class="x"> </span><span class="n">_</span><span class="p">,</span><span class="x"> </span><span class="n">block</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="k">range</span><span class="x"> </span><span class="n">temp</span><span class="x"> </span><span class="p">{</span><span class="x">
			</span><span class="k">if</span><span class="x"> </span><span class="n">block</span><span class="o">.</span><span class="n">Validator</span><span class="x"> </span><span class="o">==</span><span class="x"> </span><span class="n">lotteryWinner</span><span class="x"> </span><span class="p">{</span><span class="x">
				</span><span class="n">mutex</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span><span class="x">
				</span><span class="n">Blockchain</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="nb">append</span><span class="p">(</span><span class="n">Blockchain</span><span class="p">,</span><span class="x"> </span><span class="n">block</span><span class="p">)</span><span class="x">
				</span><span class="n">mutex</span><span class="o">.</span><span class="n">Unlock</span><span class="p">()</span><span class="x">
				</span><span class="k">for</span><span class="x"> </span><span class="n">_</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="k">range</span><span class="x"> </span><span class="n">validators</span><span class="x"> </span><span class="p">{</span><span class="x">
					</span><span class="n">announcements</span><span class="x"> </span><span class="o">&lt;-</span><span class="x"> </span><span class="s">"</span><span class="se">\n</span><span class="s">winning validator: "</span><span class="x"> </span><span class="o">+</span><span class="x"> </span><span class="n">lotteryWinner</span><span class="x"> </span><span class="o">+</span><span class="x"> </span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="x">
				</span><span class="p">}</span><span class="x">
				</span><span class="k">break</span><span class="x">
			</span><span class="p">}</span><span class="x">
		</span><span class="p">}</span><span class="x">
	</span><span class="p">}</span><span class="x">
	</span><span class="c">//清空tempBlocks，以便下次提议的进行。</span><span class="x">
	</span><span class="n">mutex</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span><span class="x">
	</span><span class="n">tempBlocks</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="p">[]</span><span class="n">Block</span><span class="p">{}</span><span class="x">
	</span><span class="n">mutex</span><span class="o">.</span><span class="n">Unlock</span><span class="p">()</span><span class="x">
</span><span class="p">}</span><span class="x">

</span><span class="c">//区块验证者添加自己的区块</span><span class="x">
</span><span class="k">func</span><span class="x"> </span><span class="n">generateBlock</span><span class="p">(</span><span class="n">oldBlock</span><span class="x"> </span><span class="n">Block</span><span class="p">,</span><span class="x"> </span><span class="n">BPM</span><span class="x"> </span><span class="kt">int</span><span class="p">,</span><span class="x"> </span><span class="n">address</span><span class="x"> </span><span class="kt">string</span><span class="p">)</span><span class="x"> </span><span class="p">(</span><span class="n">Block</span><span class="p">,</span><span class="x"> </span><span class="kt">error</span><span class="p">)</span><span class="x"> </span><span class="p">{</span><span class="x">

	</span><span class="k">var</span><span class="x"> </span><span class="n">newBlock</span><span class="x"> </span><span class="n">Block</span><span class="x">

	</span><span class="n">t</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">time</span><span class="o">.</span><span class="n">Now</span><span class="p">()</span><span class="x">

	</span><span class="n">newBlock</span><span class="o">.</span><span class="n">Index</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="n">oldBlock</span><span class="o">.</span><span class="n">Index</span><span class="x"> </span><span class="o">+</span><span class="x"> </span><span class="m">1</span><span class="x">
	</span><span class="n">newBlock</span><span class="o">.</span><span class="n">Timestamp</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="n">t</span><span class="o">.</span><span class="n">String</span><span class="p">()</span><span class="x">
	</span><span class="n">newBlock</span><span class="o">.</span><span class="n">BPM</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="n">BPM</span><span class="x">
	</span><span class="n">newBlock</span><span class="o">.</span><span class="n">PrevHash</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="n">oldBlock</span><span class="o">.</span><span class="n">Hash</span><span class="x">
	</span><span class="n">newBlock</span><span class="o">.</span><span class="n">Hash</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="n">calculateBlockHash</span><span class="p">(</span><span class="n">newBlock</span><span class="p">)</span><span class="x">
	</span><span class="n">newBlock</span><span class="o">.</span><span class="n">Validator</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="n">address</span><span class="x">

	</span><span class="k">return</span><span class="x"> </span><span class="n">newBlock</span><span class="p">,</span><span class="x"> </span><span class="no">nil</span><span class="x">
</span><span class="p">}</span><span class="x">

</span></code></pre></div></div> <div class="entry-meta"> <br> <hr> <span class="entry-tags"><a href="http://localhost:4000/tags/#PoS" title="Pages tagged PoS" class="tag"><span class="term">PoS</span></a><a href="http://localhost:4000/tags/#go" title="Pages tagged go" class="tag"><span class="term">go</span></a></span> <span class="social-share"> <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/PoS/" title="Share on Facebook" class="tag"> <span class="term"><i class="fa fa-facebook-square"></i> Share</span> </a> <a href="https://twitter.com/intent/tweet?text=http://localhost:4000/PoS/" title="Share on Twitter" class="tag"> <span class="term"><i class="fa fa-twitter-square"></i> Tweet</span> </a> <a href="https://plus.google.com/share?url=http://localhost:4000/PoS/" title="Share on Google+" class="tag"> <span class="term"><i class="fa fa-google-plus-square"></i> +1</span> </a> </span> <div style="clear:both"></div> </div> </div> </div> <section id="disqus_thread" class="animated fadeInUp"></section><!-- /#disqus_thread --> </header> <!-- JS --> <script src="http://localhost:4000/assets/js/jquery-1.12.0.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.dlmenu.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.goup.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.magnific-popup.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.fitvid.min.js"></script> <script src="http://localhost:4000/assets/js/scripts.js"></script> <script type="text/javascript"> var disqus_shortname = 'taylantatli'; (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); (function () { var s = document.createElement('script'); s.async = true; s.type = 'text/javascript'; s.src = '//' + disqus_shortname + '.disqus.com/count.js'; (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s); }()); </script> <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> <!-- MathJax --> <script async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> </body> </html>
